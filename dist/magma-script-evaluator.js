exports["magma-script-evaluator"]=function(t){var i={};function a(e){if(i[e])return i[e].exports;var r=i[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,a),r.l=!0,r.exports}return a.m=t,a.c=i,a.d=function(t,i,e){a.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:e})},a.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},a.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(i,"a",i),i},a.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},a.p="",a(a.s=2)}([function(t,i){t.exports=require("moment")},function(t,i){t.exports=require("mathjs")},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"toIdValue",function(){return toIdValue}),__webpack_require__.d(__webpack_exports__,"evaluator",function(){return evaluator}),__webpack_require__.d(__webpack_exports__,"MagmaScript",function(){return MagmaScript});var mathjs__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),mathjs__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(mathjs__WEBPACK_IMPORTED_MODULE_0__),moment__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(0),moment__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_1__);const toIdValue=t=>null===t?null:void 0!==t?Array.isArray(t)?t.map(toIdValue):"object"==typeof t&&void 0!==t._idValue?t._idValue:t:void 0;function evaluator(script,entity){const $=MagmaScript.$.bind(entity),newValue=MagmaScript.newValue,_isNull=MagmaScript._isNull,value=eval(script);return toIdValue(value)}function MagmaScript(t){this.val=t}MagmaScript.prototype.value=function(){return this.val},MagmaScript.prototype.isValidJson=function(){try{JSON.parse(this.val),this.val=!0}catch(t){this.val=!1}return this},MagmaScript.prototype.plus=function(t){return MagmaScript._isNull(t)||(this.val="object"==typeof t||"function"==typeof t?this.val+t.value():this.val+t),this},MagmaScript.prototype.pow=function(t){return"object"==typeof denominator&&"function"==typeof denominator.value&&(t=t.value()),this.val=Math.pow(this.val,t),this},MagmaScript.prototype.times=function(t){return"object"==typeof t&&"function"==typeof t.value&&(t=t.value()),this.val=this.val*t,this},MagmaScript.prototype.div=function(t){return"object"==typeof t&&"function"==typeof t.value&&(t=t.value()),this.val=this.val/t,this},MagmaScript.prototype.age=function(){return MagmaScript._isNull(this.val)?this.val=void 0:("string"==typeof this.val&&(this.val=moment__WEBPACK_IMPORTED_MODULE_1___default()(this.val,"YYYY-MM-DD",!0).toDate()),this.val=Math.floor((Date.now()-this.val)/(525949.2*60*1e3))),this},MagmaScript.prototype.map=function(t,i,a){if("function"==typeof t)this.val=this.val.map(MagmaScript.newValue).map(t);else{const e=toIdValue(this.val);e in t?this.val=t[e]:void 0===a||void 0!==this.val&&null!==this.val?this.val=i:this.val=a}return this},MagmaScript.prototype.group=function(t,i,a){if(i&&i.length>0)for(let t=0;t<i.length;t++)if(this.val===i[t])return this;if(t&&t.length>0){let i=this.val;if(i<t[0]?this.val="-"+t[0]:i>=t[t.length-1]&&(this.val=t[t.length-1]+"+"),t.length>1)for(let e=1;e<t.length;e++){const r=t[e-1],n=t[e];if(r>n){this.val=a||null;break}if(i>=r&&i<n){this.val=r+"-"+n;break}}return this}return this.val=a||null,this},MagmaScript.prototype.eq=function(t){return MagmaScript._isNull(this.val)&&MagmaScript._isNull(t)?this.val=!1:MagmaScript._isNull(this.val)&&!MagmaScript._isNull(t)?this.val=!1:this.val=this.value()===t,this},MagmaScript.prototype.matches=function(t){return this.val=t.test(this.val),this},MagmaScript.prototype.isNull=function(){return this.val=MagmaScript._isNull(this.val),this},MagmaScript.prototype.not=function(){return this.val=!this.val,this},MagmaScript.prototype.or=function(t){return this.val=this.val||t.value(),this},MagmaScript.prototype.and=function(t){return this.val=this.val&&t.value(),this},MagmaScript.prototype.gt=function(t){return this.val=!MagmaScript._isNull(this.val)&&this.value()>t,this},MagmaScript.prototype.lt=function(t){return this.val=!MagmaScript._isNull(this.val)&&this.value()<t,this},MagmaScript.prototype.ge=function(t){return this.val=!MagmaScript._isNull(this.val)&&this.value()>=t,this},MagmaScript.prototype.le=function(t){return this.val=!MagmaScript._isNull(this.val)&&this.value()<=t,this},MagmaScript.prototype.unit=function(t){return t?(this.unit=t,this):this.unit},MagmaScript.prototype.toUnit=function(t){const i=mathjs__WEBPACK_IMPORTED_MODULE_0___default.a.unit(this.val,this.unit);return this.val=i.toNumber(t),this},MagmaScript.$=function(t){const i=t.split(".");let a=this;for(let t=0;t<i.length&&null!==a;t++)a=a[i[t]];return new MagmaScript(a)},MagmaScript._isNull=function(t){return null===t||void 0===t||"string"==typeof t&&0===t.length},MagmaScript.newValue=function(t){return new MagmaScript(t)},__webpack_exports__.default=MagmaScript}]);